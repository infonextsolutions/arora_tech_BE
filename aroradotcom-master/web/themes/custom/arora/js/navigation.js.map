{"version":3,"file":"navigation.js","sources":["packages/navigation/src/navigation.es6.js"],"sourcesContent":["/**\n * Navigation\n * @file Drop down navigation handler.\n */\n\nclass Navigation {\n  constructor(nav, navClass) {\n    this.nav = nav;\n    this.navClass = navClass;\n    this.openModifier = `${this.navClass}--open`;\n    this.levelOpenModifier = `${this.navClass}-level--open`;\n    this.level2Class = `${this.navClass}-level-2`;\n    this.level2ClassRev = `${this.navClass}-level-2--reverse`;\n    this.level3Class = `${this.navClass}-level-3`;\n    this.level3ClassRev = `${this.navClass}-level-3--reverse`;\n    this.subNavClass = `${this.navClass}-has-subnav`;\n    this.subToggleClass = `${this.navClass}-sub-toggle`;\n    this.activeClass = 'is-active-menu';\n\n    this.init = this.init.bind(this);\n    this.handleToggle = this.handleToggle.bind(this);\n    this.setOrientation = this.setOrientation.bind(this);\n    this.handleKeyPress = this.handleKeyPress.bind(this);\n  }\n\n  init() {\n    const subNavItems = this.nav.querySelectorAll(`.${this.subNavClass}`);\n    const subNavLinks = this.nav.querySelectorAll(`.${this.subNavClass} > a`);\n    const navLinks = this.nav.querySelectorAll('li > a');\n    const subNavToggles = this.nav.querySelectorAll(`.${this.subToggleClass}`);\n    const activeMenu = this.nav.querySelectorAll(`.${this.activeClass}`);\n\n    subNavItems.forEach((item) => {\n      if (this.navClass !== 'nav-sidebar') {\n        if (window.innerWidth >= 768) {\n          item.addEventListener('mouseenter', this.handleToggle);\n          item.addEventListener('mouseleave', this.handleToggle);\n        }\n        this.setOrientation(item);\n      }\n    });\n\n    subNavLinks.forEach((item) => {\n      if (this.navClass !== 'nav-sidebar') {\n        item.addEventListener('touchend', this.handleToggle);\n      }\n    });\n\n    navLinks.forEach((item) => {\n      item.addEventListener('keydown', this.handleKeyPress);\n    });\n\n    subNavToggles.forEach((item) => {\n      item.addEventListener('click', this.handleToggle);\n    });\n\n    if (this.navClass === 'nav-sidebar') {\n      activeMenu.forEach((item) => {\n        const submenu = item.querySelector('ul');\n        if (submenu) {\n          this.openLevel(submenu, item);\n        }\n      });\n    }\n  }\n\n  handleToggle(event) {\n    let menuItem = event.target;\n    if (menuItem.tagName !== 'LI') {\n      menuItem = menuItem.parentElement;\n    }\n    const subNav = menuItem.querySelector('ul');\n\n    if (subNav.classList.contains(this.openModifier)) {\n      this.closeLevel(subNav, menuItem);\n    }\n    else {\n      if (event.type === 'touchend') {\n        event.preventDefault();\n      }\n      this.openLevel(subNav, menuItem);\n    }\n  }\n\n  openLevel(subNav, menuItem) {\n    subNav.classList.add(this.openModifier);\n    menuItem.classList.add(this.levelOpenModifier);\n    if (this.navClass === 'nav-sidebar') {\n      menuItem.querySelector('button').setAttribute('aria-expanded', 'true');\n    }\n    else {\n      menuItem.querySelector('a').setAttribute('aria-expanded', 'true');\n    }\n  }\n\n  closeLevel(subNav, menuItem) {\n    subNav.classList.remove(this.openModifier);\n    this.setOrientation(menuItem);\n    menuItem.classList.remove(this.levelOpenModifier);\n    if (this.navClass === 'nav-sidebar') {\n      menuItem.querySelector('button').setAttribute('aria-expanded', 'false');\n    }\n    else {\n      menuItem.querySelector('a').setAttribute('aria-expanded', 'false');\n    }\n  }\n\n  setOrientation(item) {\n    let subNav = item.querySelector(`.${this.level2Class}`);\n    let reverseClass = this.level2ClassRev;\n    if (!subNav) {\n      subNav = item.querySelector(`.${this.level3Class}`);\n      reverseClass = this.level3ClassRev;\n    }\n    const subNavRight = subNav.getBoundingClientRect().right;\n    if (window.innerWidth < subNavRight) {\n      subNav.classList.add(reverseClass);\n    }\n  }\n\n  handleKeyPress(event) {\n    const parent = event.currentTarget.parentNode;\n    const nav = parent.parentNode;\n\n    if (parent === nav.firstElementChild) {\n      // If we shift tab past the first child, toggle this level.\n      if (event.key === 'Tab' && event.shiftKey === true) {\n        this.closeLevel(nav, nav.parentNode);\n      }\n    }\n    else if (parent === nav.lastElementChild) {\n      // If we tab past the last child, toggle this level.\n      if (event.key === 'Tab' && event.shiftKey === false) {\n        this.closeLevel(nav, nav.parentNode);\n      }\n    }\n\n    // Toggle nav on Space (32) or any Arrow key (37-40).\n    switch (event.keyCode) {\n      case 32:\n      case 37:\n      case 38:\n      case 39:\n      case 40:\n        event.preventDefault();\n        this.handleToggle(event);\n        break;\n      default:\n        break;\n    }\n  }\n}\n\n/**\n * Initialise for default classes.\n */\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Activate the main navigation.\n  document.querySelectorAll('.nav-main').forEach((obj) => {\n    const mainNavigation = new Navigation(obj, 'nav-main');\n    mainNavigation.init();\n  });\n\n  // Activate the sidebar navigation.\n  document.querySelectorAll('.nav-sidebar').forEach((obj) => {\n    const sidebarNavigation = new Navigation(obj, 'nav-sidebar');\n    sidebarNavigation.init();\n  });\n});\n\nexport default Navigation;\n"],"names":["Navigation","nav","navClass","openModifier","levelOpenModifier","level2Class","level2ClassRev","level3Class","level3ClassRev","subNavClass","subToggleClass","activeClass","init","bind","handleToggle","setOrientation","handleKeyPress","subNavItems","querySelectorAll","subNavLinks","navLinks","subNavToggles","activeMenu","forEach","item","window","innerWidth","addEventListener","submenu","querySelector","openLevel","event","menuItem","target","tagName","parentElement","subNav","classList","contains","closeLevel","type","preventDefault","add","setAttribute","remove","reverseClass","subNavRight","getBoundingClientRect","right","parent","currentTarget","parentNode","firstElementChild","key","shiftKey","lastElementChild","keyCode","document","obj","mainNavigation","sidebarNavigation"],"mappings":"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"}